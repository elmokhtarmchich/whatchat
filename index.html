<!DOCTYPE html>
<html lang="en">
<head>
<meta name='viewport' content='width=300, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' />
<title>WhatsApp One Click</title>
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
 
<meta charset="utf-8">
<link href="./styles.css" rel="stylesheet">
<script src="./index.js" defer></script>
<link rel="manifest" href="/manifest.webmanifest">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />                
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">

<style>
</style>

</head>
<body>

<div class="container">

<form  id="login" onsubmit="process(event)">
<div>
<p class="act">Type phone number her:</p>
<input id="phone" type="tel" name="phone" autofocus>
<div>
<br>
<input id="btn1" type="submit" class="btn" value="Verify format" />
<div class="alert alert-info" style="display: none;"></div>
</form>
 
<p class="divider"></p>
<button id="btn2" class="btn" onclick="openChat()" style="display: block;">Chat on WhatsApp</button>
</div>

</body>

<footer>
<div class="footer">
<input class="add-button" type="button" value="Add Web App">
</div>
</footer>

<script>
function getIp(callback) {
 fetch('https://ipinfo.io/json?token=f0076d2b18eca7', { headers: { 'Accept': 'application/json' }})
   .then((resp) => resp.json())
   .catch(() => {
     return {
       country: 'us',
     };
   })
   .then((resp) => callback(resp.country));
}

  const phoneInputField = document.querySelector("#phone");
const phoneInput = window.intlTelInput(phoneInputField, {
 initialCountry: "auto",
   separateDialCode: "false",

 geoIpLookup: getIp,
 utilsScript:
   "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
});

const info = document.querySelector(".alert-info");

function process(event) {
 event.preventDefault();

 const phoneNumber = phoneInput.getNumber();

 info.style.display = "";
 info.innerHTML = `Phone number in E.164 format: <strong>${phoneNumber}</strong>`;
}

function openChat() {
const phoneNumber = phoneInput.getNumber();

    if (phoneNumber.length > 0) {
      window.location.href = "https://api.whatsapp.com/send?phone=" + phoneNumber;
    } else {
      alert("Please enter a valid phone number");
    }
}

</script>
<script>

var siteWidth = 300;
var scale = screen.width /siteWidth;

document.querySelector('meta[name="viewport"]').setAttribute('content', 'width='+siteWidth+', initial-scale='+scale+'');
</script>

</html>
