<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha384-V6yzBs6gaFVp8MsdPo3wAxnNyujAEbxYKqZvX+x3MTT7ENeIkG1+dOsWgP6ymEID" crossorigin="anonymous">
<meta name='viewport' content='width=330, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' />
<title>WhatsApp One Click</title>

	<!-- / FAVICON -->
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<script src="./index.js" defer></script>

<link rel="manifest" href="/manifest.webmanifest">

	<!-- / FAVICON -->


<meta charset="utf-8">
<link href="./styles.css" rel="stylesheet">

	<!-- / TOPNAV -->
<link href="./topnav.css" rel="stylesheet">
	<!-- / TOPNAV -->


<link rel="stylesheet" href="./intlTelInput.css" />                
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">

<style>
</style>

</head>
<body>
	<!-- / TOPNAV -->
<div class="topnav" id="myTopnav">
<a class="active" ><img href="watsapgo.net" class="logo" src="./favicon/app-icon_192x192.png" ></a>
<a href="#contact"><img class="img" src="./icon/contact.svg"></a>
<a onclick="notifyMe()"><img class="img" src="./icon/bell.svg"></a>
<a onclick="addToHomescreen()" ><img class="img" src="./icon/app.svg"></a>
<a href="#home" onclick="window.location.reload(true);"><img class="img" src="./icon/home.svg"></a>
</div>
	<!-- / TOPNAV -->


<div class="container">

<form  id="login" onsubmit="process(event)">
<div></div>
<p class="act">Type phone number her:</p>
<input id="phone" type="tel" name="phone" autofocus>
<button id="btn3">
  <img src="icon/paste.svg">
</button>
<div>
<br>
<input id="btn1" type="submit" class="btn" value="Verify format" />
<div class="alert alert-info" style="display: none;"></div>
</form>
 
<p class="divider"></p>
<button id="btn2" class="btn" onclick="openChat()" style="display: block;">Open Chat</button>
</div>

</body>

<footer>
<div class="footer">
<input class="add-button" type="button" value="Add Web App">
</div>
</footer>


	<!-- / Scale-screen -->

<script>
var siteWidth = 330;
var scale = screen.width /siteWidth;
document.querySelector('meta[name="viewport"]').setAttribute('content', 'width='+siteWidth+', initial-scale='+scale+'');
</script>
	<!-- / Scale-screen -->


	<!-- / paste -->


  <script>
    function getIp(callback) {
      fetch('https://ipinfo.io/json?token=f0076d2b18eca7', { headers: { 'Accept': 'application/json' }})
        .then((resp) => resp.json())
        .catch(() => {
          return {
            country: 'US', // Default to US if IPInfo lookup fails
          };
        })
        .then((resp) => callback(resp.country));
    }
    
    const phoneInputField = document.querySelector("#phone");
    const phoneInput = window.intlTelInput(phoneInputField, {
      initialCountry: "auto",
      separateDialCode: "false",
      geoIpLookup: getIp,
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });
    
    const info = document.querySelector(".alert-info");
    
    function process(event) {
      event.preventDefault();
    
      const phoneNumber = phoneInput.getNumber();
    
      info.style.display = "";
      info.innerHTML = `Phone number in E.164 format: <strong>${phoneNumber}</strong>`;
    }
    
  </script>
    <script>

function openChat() {
const phoneNumber = phoneInput.getNumber();

    if (phoneNumber.length > 0) {
      window.location.href = "https://api.whatsapp.com/send?phone=" + phoneNumber;
    } else {
      alert("Please enter a valid phone number");
    }
}

  </script>
    <script>

    // Add event listener to the paste button (#btn3)
    const pasteButton = document.querySelector('#btn3');
    pasteButton.addEventListener('click', async () => {
      try {
        const text = await navigator.clipboard.readText();
        // Detect and replace calling code
        const phoneNumberWithCallingCode = replaceCallingCode(text);
        // Set the formatted phone number in the input field
        phoneInput.setNumber(phoneNumberWithCallingCode);
        console.log('Pasted phone number with calling code:', phoneNumberWithCallingCode);
      } catch (error) {
        console.log('Failed to read clipboard');
      }
    });
    
    // Function to detect and replace calling code
    function replaceCallingCode(phoneNumber) {
      // Regular expression to match the calling code at the beginning of the number
      const callingCodeRegex = /^\+?\d{1,3}/;
      // Extract the calling code from the phone number
      const callingCodeMatch = phoneNumber.match(callingCodeRegex);
      if (callingCodeMatch) {
        const callingCode = callingCodeMatch[0];
        // Replace the detected calling code with the desired one
        const newCallingCode = callingCode; // Change this to the new calling code you want to use
        return phoneNumber.replace(callingCode, newCallingCode);
      }
      return phoneNumber;
    }
    </script>
    

	<!-- / paste -->
	<!-- / notifyMe -->
	<script>
function notifyMe() {
  // Let's check if the browser supports notifications
  if (!("Notification" in window)) {
    alert("This browser does not support desktop notification");
  }

  // Let's check whether notification permissions have already been granted
  else if (Notification.permission === "granted") {
    // If it's okay let's create a notification
    var notification = new Notification("Hi there!");
  }

  // Otherwise, we need to ask the user for permission
  else if (Notification.permission !== "denied") {
    Notification.requestPermission().then(function (permission) {
      // If the user accepts, let's create a notification
      if (permission === "granted") {
        var notification = new Notification("Hi there!");
      }
    });
  }

  // At last, if the user has denied notifications, and you
  // want to be respectful there is no need to bother them any more.
}
</script>
	<!-- / notifyMe -->


</html>
